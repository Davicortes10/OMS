import pandas as pd

class LeitorDataset:
    """
    Classe para leitura e an√°lise explorat√≥ria de datasets CSV.

    Esta classe permite a leitura de um arquivo CSV e fornece m√©todos para an√°lise
    inicial dos dados, incluindo:
    
    - Exibi√ß√£o de informa√ß√µes estruturais do dataset (n√∫mero de linhas, colunas e tipos de dados).
    - Gera√ß√£o de estat√≠sticas descritivas das colunas num√©ricas.
    - Identifica√ß√£o de valores ausentes.
    - Visualiza√ß√£o das primeiras linhas do dataset para uma inspe√ß√£o r√°pida.

    Attributes:
        caminho (str): Caminho do arquivo CSV.
        df (pd.DataFrame): DataFrame Pandas contendo os dados carregados.

    Methods:
        __init__(caminho): Inicializa a classe e carrega o arquivo CSV.
        informacoes(): Exibe detalhes sobre o n√∫mero de linhas, colunas e tipos de dados do dataset.
        estatisticas(): Retorna estat√≠sticas descritivas das colunas num√©ricas.
        registros_faltantes(): Identifica valores ausentes no dataset.
        primeiras_linhas(linhas=5): Exibe as primeiras linhas do dataset para uma visualiza√ß√£o inicial.
    """

    def __init__(self, caminho: str) -> None:
        """
        Inicializa a classe e carrega um arquivo CSV em um DataFrame do Pandas.

        Este m√©todo tenta carregar o arquivo CSV fornecido no par√¢metro `file_path`
        e armazen√°-lo em um DataFrame (`self.df`). Se a leitura for bem-sucedida, uma
        mensagem de confirma√ß√£o √© exibida. Caso ocorra um erro, a exce√ß√£o √© capturada
        e uma mensagem de erro √© exibida.

        Args:
            caminho (str): Caminho do arquivo CSV que ser√° carregado.

        Returns:
            None: O m√©todo apenas inicializa a inst√¢ncia da classe.

        Raises:
            FileNotFoundError: Se o arquivo especificado n√£o for encontrado.
            pd.errors.EmptyDataError: Se o arquivo CSV estiver vazio.
            pd.errors.ParserError: Se houver erro ao interpretar o arquivo CSV.
            Exception: Para qualquer outro erro inesperado.

        Example:
            >>> leitor = LeitorDataset("dados.csv")
            ‚úÖ Arquivo 'dados.csv' carregado com sucesso!

        Se o arquivo n√£o for encontrado:

            >>> leitor = CSVReader("arquivo_inexistente.csv")
            ‚ùå Erro ao carregar o arquivo: [Errno 2] No such file or directory: 'arquivo_inexistente.csv'
        """
        self.caminho = caminho
        try:
            self.df = pd.read_csv(caminho)
            print(f"‚úÖ Arquivo '{caminho}' carregado com sucesso!")
        except FileNotFoundError:
            print(f"‚ùå Erro: O arquivo '{caminho}' n√£o foi encontrado.")
        except pd.errors.EmptyDataError:
            print(f"‚ùå Erro: O arquivo '{caminho}' est√° vazio.")
        except pd.errors.ParserError:
            print(f"‚ùå Erro: O arquivo '{caminho}' n√£o p√¥de ser interpretado corretamente.")
        except Exception as e:
            print(f"‚ùå Erro ao carregar o arquivo: {e}")

    def informacoes(self) -> None:
        """
        Exibe informa√ß√µes gerais sobre o dataset, incluindo n√∫mero de linhas, colunas e tipos de dados.

        Este m√©todo imprime detalhes estruturais do DataFrame, como:
        - O n√∫mero total de entradas (linhas).
        - O n√∫mero de colunas e seus respectivos tipos de dados.
        - A contagem de valores n√£o nulos em cada coluna.
        - O uso de mem√≥ria do dataset.

        Returns:
            None: A fun√ß√£o apenas imprime as informa√ß√µes, sem retornar valores.

        Raises:
            AttributeError: Se o DataFrame (`self.df`) n√£o estiver carregado corretamente.

        Example:
            >>> leitor = LeitorDataset("dados.csv")
            >>> leitor.informacoes()

            üìå Informa√ß√µes do Dataset:
            <class 'pandas.core.frame.DataFrame'>
            RangeIndex: 1000 entries, 0 to 999
            Data columns (total 5 columns):
            #   Column   Non-Null Count  Dtype  
            ---  ------   --------------  -----  
            0   Nome     1000 non-null   object 
            1   Idade    980 non-null    float64
            2   Cidade   1000 non-null   object 
            3   Renda    950 non-null    float64
            4   Status   1000 non-null   object 
            dtypes: float64(2), object(3)
            memory usage: 39.2+ KB
        """
        # Verifica se o DataFrame foi carregado corretamente
        if not hasattr(self, 'df') or self.df is None:
            raise AttributeError("‚ùå O DataFrame n√£o foi carregado. Certifique-se de que o arquivo CSV foi lido corretamente.")

        print("\nüìå Informa√ß√µes do Dataset:")
        print(self.df.info())

    def estatisticas(self) -> None:
        """
        Exibe estat√≠sticas descritivas das colunas num√©ricas do dataset.

        Este m√©todo gera uma an√°lise estat√≠stica detalhada das colunas num√©ricas do DataFrame.
        Ele fornece m√©tricas como m√©dia, desvio padr√£o, m√≠nimo, m√°ximo e quartis (25%, 50%, 75%).
        
        Se o dataset n√£o contiver colunas num√©ricas, uma mensagem apropriada ser√° exibida.

        Returns:
            None: A fun√ß√£o imprime as estat√≠sticas, mas n√£o retorna um valor.

        Raises:
            AttributeError: Se o DataFrame (`self.df`) n√£o estiver carregado corretamente.

        Example:
            >>> leitor = LeitorDataset("dados.csv")
            >>> leitor.estatisticas()

            üìä Estat√≠sticas Descritivas:
                    Idade       Salario
            count   1000.000000  950.000000
            mean      35.467000  3200.800000
            std        8.900000   980.500000
            min       18.000000   800.000000
            25%       28.000000  2500.000000
            50%       35.000000  3200.000000
            75%       42.000000  4000.000000
            max       65.000000  9200.000000

        Se o dataset n√£o tiver colunas num√©ricas:

            üìä Estat√≠sticas Descritivas:
            ‚ùå Nenhuma coluna num√©rica encontrada no dataset.
        """
        # Verifica se o DataFrame foi carregado corretamente
        if not hasattr(self, 'df') or self.df is None:
            raise AttributeError("‚ùå O DataFrame n√£o foi carregado. Certifique-se de que o arquivo CSV foi lido corretamente.")

        print("\nüìä Estat√≠sticas Descritivas:")

        # Filtra apenas colunas num√©ricas
        df_numerico = self.df.select_dtypes(include=['number'])

        if df_numerico.empty:
            print("‚ùå Nenhuma coluna num√©rica encontrada no dataset.")
        else:
            print(df_numerico.describe())

    def registros_faltantes(self) -> None:
        """
        Identifica e exibe a contagem de valores ausentes em cada coluna do dataset.

        Este m√©todo analisa o DataFrame carregado e exibe a quantidade de valores ausentes
        (NaN) para cada coluna. Se todas as colunas estiverem completas, uma mensagem
        indicando que n√£o h√° valores ausentes ser√° exibida.

        Returns:
            None: A fun√ß√£o apenas imprime a contagem de valores ausentes, sem retornar dados.

        Raises:
            AttributeError: Se o DataFrame (`self.df`) n√£o estiver carregado corretamente.

        Example:
            >>> leitor = LeitorDataset("dados.csv")
            >>> leitor.registros_faltantes()
            
            üîç Valores Ausentes:
            Idade      3
            Salario   10
            Estado     1
            dtype: int64

        Se n√£o houver valores ausentes:

            üîç Valores Ausentes:
            ‚úÖ Nenhum valor ausente encontrado!
        """
        # Verifica se o DataFrame foi carregado corretamente
        if not hasattr(self, 'df') or self.df is None:
            raise AttributeError("‚ùå O DataFrame n√£o foi carregado. Certifique-se de que o arquivo CSV foi lido corretamente.")

        print("\nüîç Valores Ausentes:")
        missing = self.df.isnull().sum()

        # Exibe apenas colunas que possuem valores ausentes
        if missing.any():
            print(missing[missing > 0])
        else:
            print("‚úÖ Nenhum valor ausente encontrado!")

    def primeiras_linhas(self, linhas: int = 5) -> None:
        """
        Exibe as primeiras linhas do dataset para uma an√°lise inicial.

        Este m√©todo imprime as primeiras linhas do DataFrame carregado, permitindo que o usu√°rio
        tenha uma vis√£o preliminar da estrutura dos dados, incluindo os valores e poss√≠veis padr√µes.

        Args:
            linhas (int, opcional): N√∫mero de linhas a serem exibidas. 
                O valor padr√£o √© 5.

        Returns:
            None: A fun√ß√£o imprime as primeiras linhas do dataset, mas n√£o retorna nenhum valor.

        Raises:
            AttributeError: Se o DataFrame (`self.df`) n√£o estiver carregado corretamente.
            ValueError: Se o n√∫mero de linhas solicitado for menor que 1.

        Example:
            >>> leitor = LeitorDataset("dados.csv")
            >>> leitor.primeiras_linhas(3)
            Visualiza√ß√£o das 3 primeiras linhas do dataset:
            Nome  Idade    Cidade  Salario
            0  Jo√£o     28       SP   4000.0
            1  Maria    34       RJ   3500.0
            2  Pedro    45       MG   5000.0
        """
        # Verifica se o DataFrame foi carregado corretamente
        if not hasattr(self, 'df') or self.df is None:
            raise AttributeError("‚ùå O DataFrame n√£o foi carregado. Certifique-se de que o arquivo CSV foi lido corretamente.")

        # Valida se o n√∫mero de linhas solicitado √© positivo
        if linhas < 1:
            raise ValueError("‚ùå O n√∫mero de linhas deve ser pelo menos 1.")

        print(f"\n Visualiza√ß√£o das {linhas} primeiras linhas do dataset:")
        print(self.df.head(linhas))

    def executar_leitura(self) -> None:
        """
        Executa um pipeline de leitura e an√°lise do dataset.

        Este m√©todo encapsula a execu√ß√£o sequencial de outras fun√ß√µes da classe,
        proporcionando uma vis√£o geral do dataset sem a necessidade de chamar
        cada m√©todo individualmente. Ele realiza as seguintes opera√ß√µes:

        1. Exibe informa√ß√µes gerais do dataset (`informacoes()`).
        2. Mostra estat√≠sticas descritivas das colunas num√©ricas (`estatisticas()`).
        3. Identifica e exibe valores ausentes (`registros_faltantes()`).
        4. Apresenta uma amostra inicial do dataset (`primeiras_linhas()`).

        Returns:
            None: O m√©todo apenas exibe as informa√ß√µes no console.

        Raises:
            AttributeError: Se o DataFrame (`self.df`) n√£o estiver carregado corretamente.

        Example:
            >>> leitor = LeitorDataset("dados.csv")
            >>> leitor.executar_leitura()

            üìå Informa√ß√µes do Dataset:
            <class 'pandas.core.frame.DataFrame'>
            RangeIndex: 1000 entries, 0 to 999
            Data columns (total 5 columns):
            ...

            üìä Estat√≠sticas Descritivas:
                    Idade       Salario
            count   1000.000000  950.000000
            mean      35.467000  3200.800000
            ...

            üîç Valores Ausentes:
            Idade      3
            Salario   10

            üëÄ Visualiza√ß√£o das 5 primeiras linhas do dataset:
            Nome  Idade    Cidade  Salario
            0  Jo√£o     28       SP   4000.0
            1  Maria    34       RJ   3500.0
        """
        # Verifica se o DataFrame foi carregado corretamente antes de executar os m√©todos
        if not hasattr(self, 'df') or self.df is None:
            raise AttributeError("‚ùå O DataFrame n√£o foi carregado. Certifique-se de que o arquivo CSV foi lido corretamente.")

        self.informacoes()
        self.estatisticas()
        self.registros_faltantes()
        self.primeiras_linhas()




